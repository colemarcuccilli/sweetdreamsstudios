  rules_version = '2';

  service cloud.firestore {
    match /databases/{database}/documents {
      // Users collection - anyone can read/write their own
      match /users/{userId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
        allow read: if request.auth != null;
        allow create: if request.auth != null && request.auth.uid == userId;
      }

      // Bookings - SUPER SIMPLE - any authenticated user can do anything
      match /bookings/{bookingId} {
        allow read, write: if request.auth != null;
      }

      // Services - anyone can read/write if authenticated
      match /services/{serviceId} {
        allow read, write: if request.auth != null;
      }

      // Pricing Rules - anyone can read/write if authenticated
      match /pricingRules/{ruleId} {
        allow read, write: if request.auth != null;
      }

      // Stripe extension rules
      match /customers/{uid} {
        allow read: if request.auth.uid == uid;

        match /checkout_sessions/{id} {
          allow read, write: if request.auth.uid == uid;
        }
        match /subscriptions/{id} {
          allow read: if request.auth.uid == uid;
        }
        match /payments/{id} {
          allow read: if request.auth.uid == uid;
        }
      }

      match /products/{id} {
        allow read: if true;

        match /prices/{id} {
          allow read: if true;
        }
      }
    }
  }